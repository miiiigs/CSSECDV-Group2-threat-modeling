<div class="reset-password-container" style="max-width:400px;margin:40px auto;padding:30px;background:#fff;border-radius:10px;box-shadow:0 2px 8px #0001;font-family:'Segoe UI',Arial,sans-serif;">
  <h2 style="text-align:center;color:#1a237e;font-weight:700;">Answer Security Questions</h2>
  <form id="reset-password-questions-form" action="#" method="post">
    <input type="hidden" id="email" name="email" value="{{email}}" />
    {{#each questions}}
      <label style="font-weight:600;">{{this.question}}</label>
      <input type="password" name="answer{{@index}}" required style="width:100%;padding:8px;margin:8px 0 16px 0;border:1px solid #ccc;border-radius:4px;" />
    {{/each}}
    <button type="submit" style="width:100%;background:#1a237e;color:#fff;padding:10px 0;border:none;border-radius:4px;font-weight:600;">Verify Answers</button>
  </form>
  <div id="reset-password-questions-message" style="color:red;margin-top:10px;text-align:center;"></div>
  <script>
    document.getElementById('reset-password-questions-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      document.getElementById('reset-password-questions-message').textContent = '';
      const form = e.target;
      const email = form.email.value;
      const answers = Array.from(form.querySelectorAll('input[type=password]')).map(i => i.value);
      try {
        const res = await fetch('/auth/verify-security-questions', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, answers })
        });
        const data = await res.json();
        if (res.ok) {
          window.location.href = data.resetUrl;
        } else {
          document.getElementById('reset-password-questions-message').style.color = 'red';
          document.getElementById('reset-password-questions-message').textContent = data.message || 'Verification failed.';
        }
      } catch (err) {
        document.getElementById('reset-password-questions-message').style.color = 'red';
        document.getElementById('reset-password-questions-message').textContent = 'Server error.';
      }
    });
  </script>
</div>
