<div class="reset-password-container" style="max-width:400px;margin:40px auto;padding:30px;background:#fff;border-radius:10px;box-shadow:0 2px 8px #0001;font-family:'Segoe UI',Arial,sans-serif;">
  <h2 style="text-align:center;color:#1a237e;font-weight:700;">Set New Password</h2>
  <form id="reset-password-form" action="#" method="post">
    <input type="hidden" id="token" name="token" value="{{token}}" />
    <label for="newPassword" style="font-weight:600;">New Password</label>
    <input type="password" id="newPassword" name="newPassword" required style="width:100%;padding:8px;margin:8px 0 16px 0;border:1px solid #ccc;border-radius:4px;" />
    <label for="confirmNewPassword" style="font-weight:600;">Confirm New Password</label>
    <input type="password" id="confirmNewPassword" name="confirmNewPassword" required style="width:100%;padding:8px;margin:8px 0 16px 0;border:1px solid #ccc;border-radius:4px;" />
    <button type="submit" style="width:100%;background:#1a237e;color:#fff;padding:10px 0;border:none;border-radius:4px;font-weight:600;">Reset Password</button>
  </form>
  <div id="reset-password-message" style="color:red;margin-top:10px;text-align:center;"></div>
  <script>
    document.getElementById('reset-password-form').addEventListener('submit', async function(e) {
      e.preventDefault();
      document.getElementById('reset-password-message').textContent = '';
      const token = document.getElementById('token').value;
      const newPassword = document.getElementById('newPassword').value;
      const confirmNewPassword = document.getElementById('confirmNewPassword').value;
      if (newPassword !== confirmNewPassword) {
        document.getElementById('reset-password-message').textContent = 'Passwords do not match.';
        return;
      }
      try {
        const res = await fetch('/auth/reset-password', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ token, newPassword })
        });
        const data = await res.json();
        if (res.ok) {
          document.getElementById('reset-password-message').style.color = 'green';
          document.getElementById('reset-password-message').textContent = data.message || 'Password reset successful!';
          setTimeout(() => { window.location.href = '/login'; }, 2000);
        } else {
          document.getElementById('reset-password-message').style.color = 'red';
          document.getElementById('reset-password-message').textContent = data.message || 'Reset failed.';
        }
      } catch (err) {
        document.getElementById('reset-password-message').style.color = 'red';
        document.getElementById('reset-password-message').textContent = 'Server error.';
      }
    });
  </script>
</div>
